# Environment configuration for local Constellation deployment
# Copy this to .env.constellation-local and customize as needed

# ============================================================================
# CONSTELLATION LOCAL CONFIGURATION
# ============================================================================

# Enable local Constellation instance
CONSTELLATION_ENABLED=true
CONSTELLATION_LOCAL=true

# Local instance URL (used by client and app)
CONSTELLATION_URL=http://constellation-local:8080
CONSTELLATION_PORT=8080

# Data storage path (on host machine)
# Constellation uses ~2GB/day for full network indexing
CONSTELLATION_DATA_PATH=./constellation-data

# ============================================================================
# JETSTREAM CONFIGURATION
# ============================================================================

# Jetstream endpoint for AT Protocol firehose
# Options:
#   - wss://jetstream1.us-east.bsky.network/subscribe (US East primary)
#   - wss://jetstream2.us-east.bsky.network/subscribe (US East secondary)
#   - wss://jetstream1.us-west.bsky.network/subscribe (US West)
JETSTREAM_URL=wss://jetstream2.us-east.bsky.network/subscribe

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Memory limits for Constellation service
CONSTELLATION_MEMORY_LIMIT=2G
CONSTELLATION_MEMORY_RESERVATION=512M

# Cache settings for local instance
# Lower TTL since local is faster and more reliable
CONSTELLATION_CACHE_TTL=30
CONSTELLATION_TIMEOUT=10000

# Logging level (trace, debug, info, warn, error)
CONSTELLATION_LOG_LEVEL=info

# Rust backtrace (0=off, 1=on, full=verbose)
RUST_BACKTRACE=0

# ============================================================================
# CONSTELLATION VERSION
# ============================================================================

# Git branch/tag/commit to build from microcosm-rs
# Use 'main' for latest, or specify a commit hash for stability
CONSTELLATION_VERSION=main

# ============================================================================
# NOTES
# ============================================================================

# 1. First-time setup:
#    - Create data directory: mkdir -p ./constellation-data
#    - Start services: docker-compose -f docker-compose.yml -f docker-compose.constellation-local.yml up -d
#    - Monitor initial sync: docker-compose logs -f constellation-local
#
# 2. Disk space:
#    - Plan for ~2GB/day of storage
#    - Monitor with: du -sh ./constellation-data
#    - Set up log rotation and backups
#
# 3. Performance:
#    - Local instance provides <10ms latency vs 50-200ms for remote
#    - No rate limiting on local instance
#    - Suitable for high-traffic production deployments
#
# 4. Backfill:
#    - Constellation starts indexing from current time
#    - Historical data requires manual backfill (see microcosm-rs docs)
#    - Most use cases work fine with real-time data only
